name: Check input date

on:
  workflow_dispatch:
    inputs:
      environment:
        type: choice
        description: "Select environment"
        required: true
        options:
          - dev01
          - dev02
          - dev03
      start_time:
        required: true
        type: string
      end_time:
        required: true
        type: string

jobs:
  query-log-dev:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: print input
        run: |
          echo "Start Time: ${{ github.event.inputs.start_time }}"
          echo "Start End: ${{ github.event.inputs.end_time }}"
      - name: Validate time format
        id: validate
        run: |
          regex='^[0-9]{4}/[0-9]{2}/[0-9]{2}[ ][0-9]{2}:[0-9]{2}:[0-9]{2}$'
          start_time="${{ github.event.inputs.start_time }}"
          end_time="${{ github.event.inputs.end_time }}"

          if [[ ! "$start_time" =~ $regex ]] || [[ ! "$end_time" =~ $regex ]]; then
            echo "## ❌ Invalid time format. Must be 'YYYY/MM/DDTHH:MM:SS'" >> $GITHUB_STEP_SUMMARY
            exit 1
          fi
          echo "## ✅ Valid time format" >> $GITHUB_STEP_SUMMARY
